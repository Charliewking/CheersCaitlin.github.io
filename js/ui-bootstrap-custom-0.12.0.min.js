/*
 * angular-ui-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.12.0 - 2014-11-16
 * License: MIT
 */
angular.module("ui.bootstrap",["ui.bootstrap.accordion","ui.bootstrap.collapse","ui.bootstrap.transition","ui.bootstrap.bindHtml","ui.bootstrap.buttons","ui.bootstrap.modal","ui.bootstrap.tabs","ui.bootstrap.rating","ui.bootstrap.tooltip","ui.bootstrap.position","ui.bootstrap.dropdown","ui.bootstrap.popover","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse"]).constant("accordionConfig",{closeOthers:!0}).controller("AccordionController",["$scope","$attrs","accordionConfig",function(e,t,n){this.groups=[],this.closeOthers=function(o){var i=angular.isDefined(t.closeOthers)?e.$eval(t.closeOthers):n.closeOthers;i&&angular.forEach(this.groups,function(e){e!==o&&(e.isOpen=!1)})},this.addGroup=function(e){var t=this;this.groups.push(e),e.$on("$destroy",function(){t.removeGroup(e)})},this.removeGroup=function(e){var t=this.groups.indexOf(e);-1!==t&&this.groups.splice(t,1)}}]).directive("accordion",function(){return{restrict:"EA",controller:"AccordionController",transclude:!0,replace:!1,templateUrl:"template/accordion/accordion.html"}}).directive("accordionGroup",function(){return{require:"^accordion",restrict:"EA",transclude:!0,replace:!0,templateUrl:"template/accordion/accordion-group.html",scope:{heading:"@",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(e){this.heading=e}},link:function(e,t,n,o){o.addGroup(e),e.$watch("isOpen",function(t){t&&o.closeOthers(e)}),e.toggleOpen=function(){e.isDisabled||(e.isOpen=!e.isOpen)}}}}).directive("accordionHeading",function(){return{restrict:"EA",transclude:!0,template:"",replace:!0,require:"^accordionGroup",link:function(e,t,n,o,i){o.setHeading(i(e,function(){}))}}}).directive("accordionTransclude",function(){return{require:"^accordionGroup",link:function(e,t,n,o){e.$watch(function(){return o[n.accordionTransclude]},function(e){e&&(t.html(""),t.append(e))})}}}),angular.module("ui.bootstrap.collapse",["ui.bootstrap.transition"]).directive("collapse",["$transition",function(e){return{link:function(t,n,o){function i(t){function o(){s===i&&(s=void 0)}var i=e(n,t);return s&&s.cancel(),s=i,i.then(o,o),i}function a(){u?(u=!1,r()):(n.removeClass("collapse").addClass("collapsing"),i({height:n[0].scrollHeight+"px"}).then(r))}function r(){n.removeClass("collapsing"),n.addClass("collapse in"),n.css({height:"auto"})}function l(){if(u)u=!1,c(),n.css({height:0});else{n.css({height:n[0].scrollHeight+"px"});{n[0].offsetWidth}n.removeClass("collapse in").addClass("collapsing"),i({height:0}).then(c)}}function c(){n.removeClass("collapsing"),n.addClass("collapse")}var s,u=!0;t.$watch(o.collapse,function(e){e?l():a()})}}}]),angular.module("ui.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(e,t,n){function o(e){for(var t in e)if(void 0!==a.style[t])return e[t]}var i=function(o,a,r){r=r||{};var l=e.defer(),c=i[r.animation?"animationEndEventName":"transitionEndEventName"],s=function(){n.$apply(function(){o.unbind(c,s),l.resolve(o)})};return c&&o.bind(c,s),t(function(){angular.isString(a)?o.addClass(a):angular.isFunction(a)?a(o):angular.isObject(a)&&o.css(a),c||l.resolve(o)}),l.promise.cancel=function(){c&&o.unbind(c,s),l.reject("Transition cancelled")},l.promise},a=document.createElement("trans"),r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},l={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return i.transitionEndEventName=o(r),i.animationEndEventName=o(l),i}]),angular.module("ui.bootstrap.bindHtml",[]).directive("bindHtmlUnsafe",function(){return function(e,t,n){t.addClass("ng-binding").data("$binding",n.bindHtmlUnsafe),e.$watch(n.bindHtmlUnsafe,function(e){t.html(e||"")})}}),angular.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,t,n,o){var i=o[0],a=o[1];a.$render=function(){t.toggleClass(i.activeClass,angular.equals(a.$modelValue,e.$eval(n.btnRadio)))},t.bind(i.toggleEvent,function(){var o=t.hasClass(i.activeClass);(!o||angular.isDefined(n.uncheckable))&&e.$apply(function(){a.$setViewValue(o?null:e.$eval(n.btnRadio)),a.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,t,n,o){function i(){return r(n.btnCheckboxTrue,!0)}function a(){return r(n.btnCheckboxFalse,!1)}function r(t,n){var o=e.$eval(t);return angular.isDefined(o)?o:n}var l=o[0],c=o[1];c.$render=function(){t.toggleClass(l.activeClass,angular.equals(c.$modelValue,i()))},t.bind(l.toggleEvent,function(){e.$apply(function(){c.$setViewValue(t.hasClass(l.activeClass)?a():i()),c.$render()})})}}}),angular.module("ui.bootstrap.modal",["ui.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,o=0;o<e.length;o++)if(t==e[o].key){n=o;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}).directive("modalBackdrop",["$timeout",function(e){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(t,n,o){t.backdropClass=o.backdropClass||"",t.animate=!1,e(function(){t.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(e,t){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(e,t){return t.templateUrl||"template/modal/window.html"},link:function(n,o,i){o.addClass(i.windowClass||""),n.size=i.size,t(function(){n.animate=!0,o[0].querySelectorAll("[autofocus]").length||o[0].focus()}),n.close=function(t){var n=e.getTop();n&&n.value.backdrop&&"static"!=n.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),e.dismiss(n.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(e,t,n,o,i){i(e.$parent,function(e){t.empty(),t.append(e)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(e,t,n,o,i,a){function r(){for(var e=-1,t=f.keys(),n=0;n<t.length;n++)f.get(t[n]).value.backdrop&&(e=n);return e}function l(e){var t=n.find("body").eq(0),o=f.get(e).value;f.remove(e),s(o.modalDomEl,o.modalScope,300,function(){o.modalScope.$destroy(),t.toggleClass(d,f.length()>0),c()})}function c(){if(u&&-1==r()){var e=p;s(u,p,150,function(){e.$destroy(),e=null}),u=void 0,p=void 0}}function s(n,o,i,a){function r(){r.done||(r.done=!0,n.remove(),a&&a())}o.animate=!1;var l=e.transitionEndEventName;if(l){var c=t(r,i);n.bind(l,function(){t.cancel(c),r(),o.$apply()})}else t(r)}var u,p,d="modal-open",f=a.createNew(),m={};return i.$watch(r,function(e){p&&(p.index=e)}),n.bind("keydown",function(e){var t;27===e.which&&(t=f.top(),t&&t.value.keyboard&&(e.preventDefault(),i.$apply(function(){m.dismiss(t.key,"escape key press")})))}),m.open=function(e,t){f.add(e,{deferred:t.deferred,modalScope:t.scope,backdrop:t.backdrop,keyboard:t.keyboard});var a=n.find("body").eq(0),l=r();if(l>=0&&!u){p=i.$new(!0),p.index=l;var c=angular.element("<div modal-backdrop></div>");c.attr("backdrop-class",t.backdropClass),u=o(c)(p),a.append(u)}var s=angular.element("<div modal-window></div>");s.attr({"template-url":t.windowTemplateUrl,"window-class":t.windowClass,size:t.size,index:f.length()-1,animate:"animate"}).html(t.content);var m=o(s)(t.scope);f.top().value.modalDomEl=m,a.append(m),a.addClass(d)},m.close=function(e,t){var n=f.get(e);n&&(n.value.deferred.resolve(t),l(e))},m.dismiss=function(e,t){var n=f.get(e);n&&(n.value.deferred.reject(t),l(e))},m.dismissAll=function(e){for(var t=this.getTop();t;)this.dismiss(t.key,e),t=this.getTop()},m.getTop=function(){return f.top()},m}]).provider("$modal",function(){var e={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(t,n,o,i,a,r,l){function c(e){return e.template?o.when(e.template):i.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:a}).then(function(e){return e.data})}function s(e){var n=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&n.push(o.when(t.invoke(e)))}),n}var u={};return u.open=function(t){var i=o.defer(),a=o.defer(),u={result:i.promise,opened:a.promise,close:function(e){l.close(u,e)},dismiss:function(e){l.dismiss(u,e)}};if(t=angular.extend({},e.options,t),t.resolve=t.resolve||{},!t.template&&!t.templateUrl)throw new Error("One of template or templateUrl options is required.");var p=o.all([c(t)].concat(s(t.resolve)));return p.then(function(e){var o=(t.scope||n).$new();o.$close=u.close,o.$dismiss=u.dismiss;var a,c={},s=1;t.controller&&(c.$scope=o,c.$modalInstance=u,angular.forEach(t.resolve,function(t,n){c[n]=e[s++]}),a=r(t.controller,c),t.controllerAs&&(o[t.controllerAs]=a)),l.open(u,{scope:o,deferred:i,content:e[0],backdrop:t.backdrop,keyboard:t.keyboard,backdropClass:t.backdropClass,windowClass:t.windowClass,windowTemplateUrl:t.windowTemplateUrl,size:t.size})},function(e){i.reject(e)}),p.then(function(){a.resolve(!0)},function(){a.reject(!1)}),u},u}]};return e}),angular.module("ui.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(e){var t=this,n=t.tabs=e.tabs=[];t.select=function(e){angular.forEach(n,function(t){t.active&&t!==e&&(t.active=!1,t.onDeselect())}),e.active=!0,e.onSelect()},t.addTab=function(e){n.push(e),1===n.length?e.active=!0:e.active&&t.select(e)},t.removeTab=function(e){var i=n.indexOf(e);if(e.active&&n.length>1&&!o){var a=i==n.length-1?i-1:i+1;t.select(n[a])}n.splice(i,1)};var o;e.$on("$destroy",function(){o=!0})}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(e,t,n){e.vertical=angular.isDefined(n.vertical)?e.$parent.$eval(n.vertical):!1,e.justified=angular.isDefined(n.justified)?e.$parent.$eval(n.justified):!1}}}).directive("tab",["$parse",function(e){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(t,n,o){return function(t,n,i,a){t.$watch("active",function(e){e&&a.select(t)}),t.disabled=!1,i.disabled&&t.$parent.$watch(e(i.disabled),function(e){t.disabled=!!e}),t.select=function(){t.disabled||(t.active=!0)},a.addTab(t),t.$on("$destroy",function(){a.removeTab(t)}),t.$transcludeFn=o}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(e,t){e.$watch("headingElement",function(e){e&&(t.html(""),t.append(e))})}}}]).directive("tabContentTransclude",function(){function e(e){return e.tagName&&(e.hasAttribute("tab-heading")||e.hasAttribute("data-tab-heading")||"tab-heading"===e.tagName.toLowerCase()||"data-tab-heading"===e.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(t,n,o){var i=t.$eval(o.tabContentTransclude);i.$transcludeFn(i.$parent,function(t){angular.forEach(t,function(t){e(t)?i.headingElement=t:n.append(t)})})}}}),angular.module("ui.bootstrap.rating",[]).constant("ratingConfig",{max:5,stateOn:null,stateOff:null}).controller("RatingController",["$scope","$attrs","ratingConfig",function(e,t,n){var o={$setViewValue:angular.noop};this.init=function(i){o=i,o.$render=this.render,this.stateOn=angular.isDefined(t.stateOn)?e.$parent.$eval(t.stateOn):n.stateOn,this.stateOff=angular.isDefined(t.stateOff)?e.$parent.$eval(t.stateOff):n.stateOff;var a=angular.isDefined(t.ratingStates)?e.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?e.$parent.$eval(t.max):n.max);e.range=this.buildTemplateObjects(a)},this.buildTemplateObjects=function(e){for(var t=0,n=e.length;n>t;t++)e[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff},e[t]);return e},e.rate=function(t){!e.readonly&&t>=0&&t<=e.range.length&&(o.$setViewValue(t),o.$render())},e.enter=function(t){e.readonly||(e.value=t),e.onHover({value:t})},e.reset=function(){e.value=o.$viewValue,e.onLeave()},e.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),e.rate(e.value+(38===t.which||39===t.which?1:-1)))},this.render=function(){e.value=o.$viewValue}}]).directive("rating",function(){return{restrict:"EA",require:["rating","ngModel"],scope:{readonly:"=?",onHover:"&",onLeave:"&"},controller:"RatingController",templateUrl:"template/rating/rating.html",replace:!0,link:function(e,t,n,o){var i=o[0],a=o[1];a&&i.init(a)}}}),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).provider("$tooltip",function(){function e(e){var t=/[A-Z]/g,n="-";return e.replace(t,function(e,t){return(t?n:"")+e.toLowerCase()})}var t={placement:"top",animation:!0,popupDelay:0},n={mouseenter:"mouseleave",click:"click",focus:"blur"},o={};this.options=function(e){angular.extend(o,e)},this.setTriggers=function(e){angular.extend(n,e)},this.$get=["$window","$compile","$timeout","$document","$position","$interpolate",function(i,a,r,l,c,s){return function(i,u,p){function d(e){var t=e||f.trigger||p,o=n[t]||t;return{show:t,hide:o}}var f=angular.extend({},t,o),m=e(i),h=s.startSymbol(),v=s.endSymbol(),g="<div "+m+'-popup title="'+h+"title"+v+'" content="'+h+"content"+v+'" placement="'+h+"placement"+v+'" animation="animation" is-open="isOpen"></div>';return{restrict:"EA",compile:function(){var e=a(g);return function(t,n,o){function a(){D.isOpen?p():s()}function s(){(!A||t.$eval(o[u+"Enable"]))&&($(),D.popupDelay?O||(O=r(m,D.popupDelay,!1),O.then(function(e){e()})):m()())}function p(){t.$apply(function(){h()})}function m(){return O=null,E&&(r.cancel(E),E=null),D.content?(v(),k.css({top:0,left:0,display:"block"}),T?l.find("body").append(k):n.after(k),U(),D.isOpen=!0,D.$digest(),U):angular.noop}function h(){D.isOpen=!1,r.cancel(O),O=null,D.animation?E||(E=r(g,500)):g()}function v(){k&&g(),C=D.$new(),k=e(C,angular.noop)}function g(){E=null,k&&(k.remove(),k=null),C&&(C.$destroy(),C=null)}function $(){b(),y()}function b(){var e=o[u+"Placement"];D.placement=angular.isDefined(e)?e:f.placement}function y(){var e=o[u+"PopupDelay"],t=parseInt(e,10);D.popupDelay=isNaN(t)?f.popupDelay:t}function w(){var e=o[u+"Trigger"];S(),x=d(e),x.show===x.hide?n.bind(x.show,a):(n.bind(x.show,s),n.bind(x.hide,p))}var k,C,E,O,T=angular.isDefined(f.appendToBody)?f.appendToBody:!1,x=d(void 0),A=angular.isDefined(o[u+"Enable"]),D=t.$new(!0),U=function(){var e=c.positionElements(n,k,D.placement,T);e.top+="px",e.left+="px",k.css(e)};D.isOpen=!1,o.$observe(i,function(e){D.content=e,!e&&D.isOpen&&h()}),o.$observe(u+"Title",function(e){D.title=e});var S=function(){n.unbind(x.show,s),n.unbind(x.hide,p)};w();var q=t.$eval(o[u+"Animation"]);D.animation=angular.isDefined(q)?!!q:f.animation;var H=t.$eval(o[u+"AppendToBody"]);T=angular.isDefined(H)?H:T,T&&t.$on("$locationChangeSuccess",function(){D.isOpen&&h()}),t.$on("$destroy",function(){r.cancel(E),r.cancel(O),S(),g(),D=null})}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(e){return e("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("ui.bootstrap.position",[]).factory("$position",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function o(e){return"static"===(n(e,"position")||"static")}var i=function(t){for(var n=e[0],i=t.offsetParent||n;i&&i!==n&&o(i);)i=i.offsetParent;return i||n};return{position:function(t){var n=this.offset(t),o={top:0,left:0},a=i(t[0]);a!=e[0]&&(o=this.offset(angular.element(a)),o.top+=a.clientTop-a.scrollTop,o.left+=a.clientLeft-a.scrollLeft);var r=t[0].getBoundingClientRect();return{width:r.width||t.prop("offsetWidth"),height:r.height||t.prop("offsetHeight"),top:n.top-o.top,left:n.left-o.left}},offset:function(n){var o=n[0].getBoundingClientRect();return{width:o.width||n.prop("offsetWidth"),height:o.height||n.prop("offsetHeight"),top:o.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:o.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,o){var i,a,r,l,c=n.split("-"),s=c[0],u=c[1]||"center";i=o?this.offset(e):this.position(e),a=t.prop("offsetWidth"),r=t.prop("offsetHeight");var p={center:function(){return i.left+i.width/2-a/2},left:function(){return i.left},right:function(){return i.left+i.width}},d={center:function(){return i.top+i.height/2-r/2},top:function(){return i.top},bottom:function(){return i.top+i.height}};switch(s){case"right":l={top:d[u](),left:p[s]()};break;case"left":l={top:d[u](),left:i.left-a};break;case"bottom":l={top:d[s](),left:p[u]()};break;default:l={top:i.top-r,left:p[u]()}}return l}}}]),angular.module("ui.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(e){var t=null;this.open=function(i){t||(e.bind("click",n),e.bind("keydown",o)),t&&t!==i&&(t.isOpen=!1),t=i},this.close=function(i){t===i&&(t=null,e.unbind("click",n),e.unbind("keydown",o))};var n=function(e){if(t){var n=t.getToggleElement();e&&n&&n[0].contains(e.target)||t.$apply(function(){t.isOpen=!1})}},o=function(e){27===e.which&&(t.focusToggleElement(),n())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(e,t,n,o,i,a){var r,l=this,c=e.$new(),s=o.openClass,u=angular.noop,p=t.onToggle?n(t.onToggle):angular.noop;this.init=function(o){l.$element=o,t.isOpen&&(r=n(t.isOpen),u=r.assign,e.$watch(r,function(e){c.isOpen=!!e}))},this.toggle=function(e){return c.isOpen=arguments.length?!!e:!c.isOpen},this.isOpen=function(){return c.isOpen},c.getToggleElement=function(){return l.toggleElement},c.focusToggleElement=function(){l.toggleElement&&l.toggleElement[0].focus()},c.$watch("isOpen",function(t,n){a[t?"addClass":"removeClass"](l.$element,s),t?(c.focusToggleElement(),i.open(c)):i.close(c),u(e,t),angular.isDefined(t)&&t!==n&&p(e,{open:!!t})}),e.$on("$locationChangeSuccess",function(){c.isOpen=!1}),e.$on("$destroy",function(){c.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(e,t,n,o){o.init(t)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(e,t,n,o){if(o){o.toggleElement=t;var i=function(i){i.preventDefault(),t.hasClass("disabled")||n.disabled||e.$apply(function(){o.toggle()})};t.bind("click",i),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(o.isOpen,function(e){t.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){t.unbind("click",i)})}}}}),angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("popoverPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/popover/popover.html"}}).directive("popover",["$tooltip",function(e){return e("popover","popover","click")}]),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position","ui.bootstrap.bindHtml"]).factory("typeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var o=n.match(t);if(!o)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:o[3],source:e(o[4]),viewMapper:e(o[2]||o[1]),modelMapper:e(o[1])}}}}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$position","typeaheadParser",function(e,t,n,o,i,a,r){var l=[9,13,27,38,40];return{require:"ngModel",link:function(c,s,u,p){var d,f=c.$eval(u.typeaheadMinLength)||1,m=c.$eval(u.typeaheadWaitMs)||0,h=c.$eval(u.typeaheadEditable)!==!1,v=t(u.typeaheadLoading).assign||angular.noop,g=t(u.typeaheadOnSelect),$=u.typeaheadInputFormatter?t(u.typeaheadInputFormatter):void 0,b=u.typeaheadAppendToBody?c.$eval(u.typeaheadAppendToBody):!1,y=c.$eval(u.typeaheadFocusFirst)!==!1,w=t(u.ngModel).assign,k=r.parse(u.typeahead),C=c.$new();c.$on("$destroy",function(){C.$destroy()});var E="typeahead-"+C.$id+"-"+Math.floor(1e4*Math.random());s.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":E});var O=angular.element("<div typeahead-popup></div>");O.attr({id:E,matches:"matches",active:"activeIdx",select:"select(activeIdx)",query:"query",position:"position"}),angular.isDefined(u.typeaheadTemplateUrl)&&O.attr("template-url",u.typeaheadTemplateUrl);var T=function(){C.matches=[],C.activeIdx=-1,s.attr("aria-expanded",!1)},x=function(e){return E+"-option-"+e};C.$watch("activeIdx",function(e){0>e?s.removeAttr("aria-activedescendant"):s.attr("aria-activedescendant",x(e))});var A=function(e){var t={$viewValue:e};v(c,!0),n.when(k.source(c,t)).then(function(n){var o=e===p.$viewValue;if(o&&d)if(n.length>0){C.activeIdx=y?0:-1,C.matches.length=0;for(var i=0;i<n.length;i++)t[k.itemName]=n[i],C.matches.push({id:x(i),label:k.viewMapper(C,t),model:n[i]});C.query=e,C.position=b?a.offset(s):a.position(s),C.position.top=C.position.top+s.prop("offsetHeight"),s.attr("aria-expanded",!0)}else T();o&&v(c,!1)},function(){T(),v(c,!1)})};T(),C.query=void 0;var D,U=function(e){D=o(function(){A(e)},m)},S=function(){D&&o.cancel(D)};p.$parsers.unshift(function(e){return d=!0,e&&e.length>=f?m>0?(S(),U(e)):A(e):(v(c,!1),S(),T()),h?e:e?void p.$setValidity("editable",!1):(p.$setValidity("editable",!0),e)}),p.$formatters.push(function(e){var t,n,o={};return $?(o.$model=e,$(c,o)):(o[k.itemName]=e,t=k.viewMapper(c,o),o[k.itemName]=void 0,n=k.viewMapper(c,o),t!==n?t:e)}),C.select=function(e){var t,n,i={};i[k.itemName]=n=C.matches[e].model,t=k.modelMapper(c,i),w(c,t),p.$setValidity("editable",!0),g(c,{$item:n,$model:t,$label:k.viewMapper(c,i)}),T(),o(function(){s[0].focus()},0,!1)},s.bind("keydown",function(e){0!==C.matches.length&&-1!==l.indexOf(e.which)&&(-1!=C.activeIdx||13!==e.which&&9!==e.which)&&(e.preventDefault(),40===e.which?(C.activeIdx=(C.activeIdx+1)%C.matches.length,C.$digest()):38===e.which?(C.activeIdx=(C.activeIdx>0?C.activeIdx:C.matches.length)-1,C.$digest()):13===e.which||9===e.which?C.$apply(function(){C.select(C.activeIdx)}):27===e.which&&(e.stopPropagation(),T(),C.$digest()))}),s.bind("blur",function(){d=!1});var q=function(e){s[0]!==e.target&&(T(),C.$digest())};i.bind("click",q),c.$on("$destroy",function(){i.unbind("click",q),b&&H.remove()});var H=e(O)(C);b?i.find("body").append(H):s.after(H)}}}]).directive("typeaheadPopup",function(){return{restrict:"EA",scope:{matches:"=",query:"=",active:"=",position:"=",select:"&"},replace:!0,templateUrl:"template/typeahead/typeahead-popup.html",link:function(e,t,n){e.templateUrl=n.templateUrl,e.isOpen=function(){return e.matches.length>0},e.isActive=function(t){return e.active==t},e.selectActive=function(t){e.active=t},e.selectMatch=function(t){e.select({activeIdx:t})}}}}).directive("typeaheadMatch",["$http","$templateCache","$compile","$parse",function(e,t,n,o){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(i,a,r){var l=o(r.templateUrl)(i.$parent)||"template/typeahead/typeahead-match.html";e.get(l,{cache:t}).success(function(e){a.replaceWith(n(e.trim())(i))})}}}]).filter("typeaheadHighlight",function(){function e(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,n){return n?(""+t).replace(new RegExp(e(n),"gi"),"<strong>$&</strong>"):t}});